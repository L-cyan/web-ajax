<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        // xhr发起GET请求
        // 1.创建对象
        var xhr = new XMLHttpRequest()
        // 2. 调用open函数 （请求方式，url） 想要带参数的请求：（请求方式，url?xx=xx&xx=xx……查询字符串）
        xhr.open('GET','http://www.liulongbin.top:3006/api/getbooks?id=1')
        // 3.调用send函数
        xhr.send()
        // 4.监听事件
        xhr.onreadystatechange=function(){
            // 当前 Ajax 请求所处的状态完成 且服务器返回状态是成分
            if(xhr.readyState ===4 && xhr.status ===200) {
                // 服务器响应数据 responseText里也有status与上一行status不同
                console.log(xhr.responseText);
            }
        }
        // URL编码与解码
        console.log(encodeURI('黑马程序员'));
        console.log(decodeURI('%E9%BB%91%E9%A9%AC'));


        // xhr发送POST请求
        // 1 创建对象
        var  xhr1 = new XMLHttpRequest();
        // 2 调用open函数
        xhr1.open('POST','http://www.liulongbin.top:3006/api/addbook')
        // 3 设置请求头 Content-Type注意大写属性 编码格式 固定写法
        xhr1.setRequestHeader('Content-type','application/x-www-form-urlencoded')
        // 4 发送传入查询字符串形式的参数
        xhr1.send('bookname=dd&author=xx&publisher=ddd')
        // 5 监听事件
        xhr1.onreadystatechange = function(){
            if(xhr1.readyState ===4 && xhr1.status ===200){
                console.log(xhr1.responseText);
            }
        }

        // JSON 和JS对象互转
        var obj = {name:'anne',age:18} // 对象
        console.log(typeof JSON.stringify(obj)); //{"name":"anne","age":18}  string
        var json = JSON.stringify(obj) // '{name: "anne", age: 18}' 字符串
        console.log(JSON.parse(json));//{name: "anne", age: 18}
        // 应用
        
        var xhr3 = new XMLHttpRequest()    
        xhr3.open('GET','http://www.liulongbin.top:3006/api/getbooks?id=1') 
        xhr3.send()   
        xhr3.onreadystatechange=function(){      
            if(xhr3.readyState ===4 && xhr3.status ===200) {       
                console.log(xhr3.responseText);
                var obj = JSON.parse(xhr3.responseText)
                console.log(obj);
            }
        }
    </script>
</body>
</html>